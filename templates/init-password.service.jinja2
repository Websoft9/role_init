[Unit]
Description=Init Password for image
After=network.target systemd-networkd-wait-online.service

{% if init_db %}
{% for dbs in init_db %}
{% if init_service_unit[dbs].before %}
Before={{init_service_unit[dbs].before}}
{% endif %}
{% if init_service_unit[dbs].after %}
After={{init_service_unit[dbs].after}}
{% endif %}
{% endfor %}
{% endif %}

{% if init_application %}
{% for app_name,app_attr in init_application.items() %}
{% if app_attr.service_before %}
Before={{app_attr.service_before}}
{% endif %}
{% if app_attr.service_after %}
After={{app_attr.service_after}}
{% endif %}
{% endfor %}
{% endif %}

[Service]
Type=oneshot
TimeoutSec=30s
ExecStart=/bin/bash /credentials/init.sh
ExecStart=/bin/systemctl disable init-password

[Install]
WantedBy=multi-user.target
